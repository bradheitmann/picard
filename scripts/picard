#!/usr/bin/env bash
# PICARD v3.0 - Pure Bash (Simple & Reliable)
# Built on PSA foundation + adds multi-agent features

PICARD_HOME="${HOME}/.dev/picard-bash"
PSA_GLOBAL="${HOME}/.warp/scripts/psa-global-dashboard.sh"
DB="${HOME}/.dev/logs/observability.db"

# Colors
C_CYAN="\033[36m"
C_RESET="\033[0m"

# Default: Show PSA dashboard (works great!)
if [ $# -eq 0 ]; then
  # Add PICARD logo to PSA - each line colored explicitly
  printf "\033[1;36m    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—\033[0m\n"
  printf "\033[1;36m    â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—\033[0m\n"
  printf "\033[1;36m    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘\033[0m\n"
  printf "\033[1;36m    â–ˆâ–ˆâ•”â•â•â•â• â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘\033[0m\n"
  printf "\033[1;36m    â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•\033[0m\n"
  printf "\033[1;36m    â•šâ•â•     â•šâ•â• â•šâ•â•â•â•â•â•â•šâ•â•  â•šâ•â•â•šâ•â•  â•šâ•â•â•šâ•â•â•â•â•â•\033[0m\n"
  printf "\033[36m    ğŸ–– Multi-Agent Orchestration + Project State Awareness\033[0m\n\n"
  exec "$PSA_GLOBAL"
fi

# Route commands
case "$1" in
  # PSA commands (use originals)
  init|new-project)
    exec ~/.warp/scripts/init-project.sh "${@:2}"
    ;;

  # PICARD message broker (bash)
  send-message|msg)
    exec "$PICARD_HOME/scripts/core/message-send" "${@:2}"
    ;;

  # PICARD workflow (bash)
  workflow|pm-dev-qa)
    exec "$PICARD_HOME/scripts/workflows/pm-dev-qa" "${@:2}"
    ;;

  # Database commands (sqlite3)
  task)
    exec "$PICARD_HOME/scripts/core/task-manager" "${@:2}"
    ;;

  *)
    echo "Unknown command: $1"
    echo "Run 'picard' for menu"
    exit 1
    ;;
esac
